"use strict";(self["webpackChunkportfolio"]=self["webpackChunkportfolio"]||[]).push([[838],{8838:function(e,t,l){l.r(t),l.d(t,{default:function(){return u}});var a=function(){var e=this,t=e._self._c;return t("el-tabs",{on:{"tab-click":function(e){}},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:"多元學習",name:"1"}},["1"==e.activeName?[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.MultipleLearning}},[t("el-form-item",{attrs:{label:"學年："}},[t("selectYear",{attrs:{year_id:e.MultipleLearning.year_id},on:{"get-year":e.MultipleLearningGetyear}})],1),t("el-form-item",{attrs:{label:"年級："}},[t("el-select",{attrs:{placeholder:"請選擇"},on:{change:e.MultipleLearningChangeGrdId},model:{value:e.MultipleLearning.grd_id,callback:function(t){e.$set(e.MultipleLearning,"grd_id",t)},expression:"MultipleLearning.grd_id"}},[t("el-option",{attrs:{label:"一年級",value:"1"}}),t("el-option",{attrs:{label:"二年級",value:"2"}}),t("el-option",{attrs:{label:"三年級",value:"3"}})],1)],1),3==e.MultipleLearning.grd_id?t("el-form-item",{attrs:{label:"類別："}},[t("el-select",{attrs:{placeholder:"請選擇"},model:{value:e.MultipleLearning.type,callback:function(t){e.$set(e.MultipleLearning,"type",t)},expression:"MultipleLearning.type"}},[t("el-option",{attrs:{label:"第一梯次多元表現",value:"35"}}),t("el-option",{attrs:{label:"第二梯次多元表現",value:"75"}})],1)],1):e._e(),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.MultipleLearningExportExcel}},[e._v("匯出")])],1)],1)]:e._e()],2),t("el-tab-pane",{attrs:{label:"學習成果",name:"2"}},["2"==e.activeName?[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.LearningResult}},[t("el-form-item",{attrs:{label:"學年："}},[t("selectYear",{attrs:{year_id:e.LearningResult.year_id},on:{"get-year":e.LearningResultGetyear}})],1),t("el-form-item",{attrs:{label:"年級："}},[t("el-select",{attrs:{placeholder:"請選擇"},on:{change:e.LearningResultChangeGrdId},model:{value:e.LearningResult.grd_id,callback:function(t){e.$set(e.LearningResult,"grd_id",t)},expression:"LearningResult.grd_id"}},[t("el-option",{attrs:{label:"一年級",value:"1"}}),t("el-option",{attrs:{label:"二年級",value:"2"}}),t("el-option",{attrs:{label:"三年級",value:"3"}})],1)],1),t("el-form-item",{attrs:{label:"類別："}},[3!=e.LearningResult.grd_id?t("el-select",{attrs:{placeholder:"請選擇"},model:{value:e.LearningResult.type,callback:function(t){e.$set(e.LearningResult,"type",t)},expression:"LearningResult.type"}},[t("el-option",{attrs:{label:"學生課程學習成果",value:"26"}}),t("el-option",{attrs:{label:"進修部學生課程學習成果",value:"28"}})],1):3==e.LearningResult.grd_id?t("el-select",{attrs:{placeholder:"請選擇"},model:{value:e.LearningResult.type,callback:function(t){e.$set(e.LearningResult,"type",t)},expression:"LearningResult.type"}},[t("el-option",{attrs:{label:"第一梯次學生課程學習成果",value:"36"}}),t("el-option",{attrs:{label:"第二梯次學生課程學習成果",value:"76"}}),t("el-option",{attrs:{label:"第一梯次進修部學生課程學習成果",value:"38"}}),t("el-option",{attrs:{label:"第二梯次進修部學生課程學習成果",value:"78"}})],1):e._e()],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.LearningResultExportExcel}},[e._v("匯出")])],1)],1)]:e._e()],2),t("el-tab-pane",{attrs:{label:"幹部",name:"3"}},["3"==e.activeName?[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.StdPositionFromSch}},[t("el-form-item",{attrs:{label:"學年："}},[t("selectYear",{attrs:{year_id:e.StdPositionFromSch.year_id},on:{"get-year":e.StdPositionFromSchGetyear}})],1),t("el-form-item",{attrs:{label:"學期："}},[t("selectSms",{attrs:{sms_id:e.StdPositionFromSch.sms_id,isShowShort:!0},on:{"get-sms":e.StdPositionFromSchGetsms}})],1),t("el-form-item",{attrs:{label:"年級："}},[t("el-select",{attrs:{placeholder:"請選擇"},on:{change:e.StdPositionFromSchChangeGrdId},model:{value:e.StdPositionFromSch.grd_id,callback:function(t){e.$set(e.StdPositionFromSch,"grd_id",t)},expression:"StdPositionFromSch.grd_id"}},[t("el-option",{attrs:{label:"一年級",value:"1"}}),t("el-option",{attrs:{label:"二年級",value:"2"}}),t("el-option",{attrs:{label:"三年級",value:"3"}})],1)],1),3==e.StdPositionFromSch.grd_id?t("el-form-item",{attrs:{label:"類別："}},[t("el-select",{attrs:{placeholder:"請選擇"},model:{value:e.StdPositionFromSch.type,callback:function(t){e.$set(e.StdPositionFromSch,"type",t)},expression:"StdPositionFromSch.type"}},[t("el-option",{attrs:{label:"第一梯次校內幹部",value:"34"}}),t("el-option",{attrs:{label:"第二梯次校內幹部",value:"74"}})],1)],1):e._e(),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.StdPositionFromSchExportExcel}},[e._v("匯出")])],1)],1)]:e._e()],2)],1)},n=[],r=l(4070),i=l(2835),o={name:"ExportExcel",data:function(){return{activeName:"1",urlObject:{MultipleLearning:"/ExportExcel/MultipleLearning",LearningResult:"/ExportExcel/LearningResult",StdPositionFromSch:"/ExportExcel/StdPositionFromSch"},MultipleLearning:{year_id:null,grd_id:null,type:"25",token:this.$token},LearningResult:{year_id:null,grd_id:null,type:null,token:this.$token},StdPositionFromSch:{year_id:null,sms_id:null,grd_id:null,type:"24",token:this.$token}}},components:{selectYear:r.Z,selectSms:i.Z},methods:{saveAs(e,t){const{headers:l,data:a}=e;let n="";switch(t){case"24":n="校內幹部經歷名冊";break;case"25":n="多元學習表現";break;case"26":n="學生課程學習成果";break;case"28":n="進修部學生課程學習成果";break;case"34":n="第一梯次高三校內幹部經歷名冊";break;case"35":n="第一梯次多元學習表現";break;case"36":n="第一梯次學生課程學習成果";break;case"38":n="第一梯次進修部學生課程學習成果";break;case"74":n="第二梯次高三校內幹部經歷名冊";break;case"75":n="第二梯次多元學習表現";break;case"76":n="第二梯次學生課程學習成果";break;case"78":n="第二梯次進修部學生課程學習成果";break}n+=".xlsx";let r=new Blob([a],{type:l["content-type"]});if("download"in document.createElement("a")){let e=document.createElement("a");e.download=n,e.style.displya="none",e.href=URL.createObjectURL(r),document.body.appendChild(e),e.click(),URL.revokeObjectURL(e.href),document.body.removeChild(e)}else navigator.msSaveBold(r,n)},MultipleLearningGetyear:function(e){this.MultipleLearning.year_id=e},MultipleLearningChangeGrdId(e){this.MultipleLearning.type=3==e?"35":"25"},MultipleLearningExportExcel(){const e=this,t=`${e.$apiroot}${e.urlObject.MultipleLearning}`;if(null==e.MultipleLearning.year_id||null==e.MultipleLearning.grd_id)return e.$message.error("請選擇學年及年級！"),!1;const l=e.$loading({lock:!0,text:"資料讀取中，請稍後。",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});e.axios.get(t,{params:e.MultipleLearning,responseType:"blob",headers:{SkyGet:e.$token}}).then((t=>{e.saveAs(t,e.MultipleLearning.type)})).catch((t=>{e.$message.error("發生錯誤:"+t)})).finally((()=>l.close()))},LearningResultGetyear:function(e){this.LearningResult.year_id=e},LearningResultChangeGrdId(e){this.LearningResult.type=3==e?"36":"26"},LearningResultExportExcel(){const e=this,t=`${e.$apiroot}${e.urlObject.LearningResult}`;if(null==e.LearningResult.year_id||null==e.LearningResult.grd_id||null==e.LearningResult.type)return e.$message.error("請選擇學年、年級、類別！"),!1;const l=e.$loading({lock:!0,text:"資料讀取中，請稍後。",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});e.axios.get(t,{params:e.LearningResult,responseType:"blob",headers:{SkyGet:e.$token}}).then((t=>{e.saveAs(t,e.LearningResult.type)})).catch((t=>{e.$message.error("發生錯誤:"+t)})).finally((()=>l.close()))},StdPositionFromSchGetyear:function(e){this.StdPositionFromSch.year_id=e},StdPositionFromSchGetsms:function(e){this.StdPositionFromSch.sms_id=e},StdPositionFromSchChangeGrdId(e){this.StdPositionFromSch.type=3==e?"34":"24"},StdPositionFromSchExportExcel(){const e=this,t=`${e.$apiroot}${e.urlObject.StdPositionFromSch}`;if(null==e.StdPositionFromSch.year_id||null==e.StdPositionFromSch.sms_id||null==e.StdPositionFromSch.grd_id||null==e.StdPositionFromSch.type)return e.$message.error("請選擇學年、學期、年級！"),!1;const l=e.$loading({lock:!0,text:"資料讀取中，請稍後。",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});e.axios.get(t,{params:e.StdPositionFromSch,responseType:"blob",headers:{SkyGet:e.$token}}).then((t=>{e.saveAs(t,e.StdPositionFromSch.type)})).catch((t=>{e.$message.error("發生錯誤:"+t)})).finally((()=>l.close()))}},async beforeMount(){},mounted(){}},s=o,c=l(1001),d=(0,c.Z)(s,a,n,!1,null,null,null),u=d.exports}}]);